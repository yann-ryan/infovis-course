<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Information Visualization and the Humanities - 2&nbsp; Introduction to R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./datavis-0.html" rel="next">
<link href="./r-markdown.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./r-intro.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to R</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Information Visualization and the Humanities</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-markdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction and Using R Markdown</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-intro.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datavis-0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Visualisation 0</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-visualisation-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Visualisation 1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-visualisation-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Visualisation 2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./digital-mapping-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Digital mapping 1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./digital-mapping-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Digital Mapping 2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./digital-mapping-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Digital Mapping 3</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./network-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Network Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Finishing Touches: Creating Narratives with Your Datavis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./final-project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Final Project</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Assignment 1: Visualize This!</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Assignment 2: Make a map</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#class-objectives" id="toc-class-objectives" class="nav-link active" data-scroll-target="#class-objectives">Class Objectives</a>
  <ul class="collapse">
  <li><a href="#what-if-i-get-stuck" id="toc-what-if-i-get-stuck" class="nav-link" data-scroll-target="#what-if-i-get-stuck">What if I get stuck?</a></li>
  </ul></li>
  <li><a href="#load-r-studio-using-posit-cloud" id="toc-load-r-studio-using-posit-cloud" class="nav-link" data-scroll-target="#load-r-studio-using-posit-cloud">Load R Studio using Posit cloud</a></li>
  <li><a href="#open-the-.rmd-file" id="toc-open-the-.rmd-file" class="nav-link" data-scroll-target="#open-the-.rmd-file">Open the .Rmd file</a></li>
  <li><a href="#r-code" id="toc-r-code" class="nav-link" data-scroll-target="#r-code">R code</a></li>
  <li><a href="#installing-and-loading-packages" id="toc-installing-and-loading-packages" class="nav-link" data-scroll-target="#installing-and-loading-packages">Installing and loading packages</a></li>
  <li><a href="#loading-existing-packages" id="toc-loading-existing-packages" class="nav-link" data-scroll-target="#loading-existing-packages">Loading existing packages</a>
  <ul class="collapse">
  <li><a href="#base-r." id="toc-base-r." class="nav-link" data-scroll-target="#base-r.">‘Base’ R.</a></li>
  <li><a href="#basic-r-data-structures" id="toc-basic-r-data-structures" class="nav-link" data-scroll-target="#basic-r-data-structures">Basic R data structures</a></li>
  <li><a href="#environment" id="toc-environment" class="nav-link" data-scroll-target="#environment">Environment</a></li>
  <li><a href="#data-types" id="toc-data-types" class="nav-link" data-scroll-target="#data-types">Data types</a></li>
  </ul></li>
  <li><a href="#tidyverse" id="toc-tidyverse" class="nav-link" data-scroll-target="#tidyverse">Tidyverse</a>
  <ul class="collapse">
  <li><a href="#select-pull" id="toc-select-pull" class="nav-link" data-scroll-target="#select-pull">select(), pull()</a></li>
  <li><a href="#group_by-summarise-tally" id="toc-group_by-summarise-tally" class="nav-link" data-scroll-target="#group_by-summarise-tally">group_by(), summarise(), tally()</a></li>
  <li><a href="#filter" id="toc-filter" class="nav-link" data-scroll-target="#filter">filter()</a></li>
  <li><a href="#mutate" id="toc-mutate" class="nav-link" data-scroll-target="#mutate">mutate()</a></li>
  <li><a href="#slice_max-slice_min" id="toc-slice_max-slice_min" class="nav-link" data-scroll-target="#slice_max-slice_min">slice_max(), slice_min()</a></li>
  <li><a href="#sort-arrange" id="toc-sort-arrange" class="nav-link" data-scroll-target="#sort-arrange">sort(), arrange()</a></li>
  <li><a href="#left_join-inner_join-anti_join" id="toc-left_join-inner_join-anti_join" class="nav-link" data-scroll-target="#left_join-inner_join-anti_join">left_join(), inner_join(), anti_join()</a></li>
  <li><a href="#piping" id="toc-piping" class="nav-link" data-scroll-target="#piping">Piping</a></li>
  </ul></li>
  <li><a href="#reading-in-external-data" id="toc-reading-in-external-data" class="nav-link" data-scroll-target="#reading-in-external-data">Reading in external data</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to R</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="class-objectives" class="level2">
<h2 class="anchored" data-anchor-id="class-objectives">Class Objectives</h2>
<p>This week, we’re going to get used to the environment we’ll use for creating the visualisations for this course. By the end of today, you should be comfortable with the interface, and able to use R, load packages, and do some basic manipulations of dataframes.</p>
<section id="what-if-i-get-stuck" class="level3">
<h3 class="anchored" data-anchor-id="what-if-i-get-stuck">What if I get stuck?</h3>
<p>It’s OK! Take your orange post-it, and place it on the back of your computer. I’ll come around to help as soon as possible.</p>
<p>If you’ve finished everything, put up your green post-it. I’ll give you some advanced exercises to complete.</p>
</section>
</section>
<section id="load-r-studio-using-posit-cloud" class="level2">
<h2 class="anchored" data-anchor-id="load-r-studio-using-posit-cloud">Load R Studio using Posit cloud</h2>
<p>As last week, we’ll open R using Posit cloud. Use the sidebar to switch to the ‘Information Visualisation and the Humanities’ Workspace, and click on the new assignment, for week 2, called ‘Week 2: Introduction to R’:</p>
<p><img src="images/Screenshot 2023-08-31 at 11.59.31.png" class="img-fluid" width="800"></p>
<p>You’ll see an existing .Rmd file in the file manager in the bottom right. This is a ‘live’ version of this book chapter. It contains code cells and text. The first part of this practical session simply involves running these cells in the correct order, and looking at the output.</p>
<p>You should now switch to reading this in the .Rmd file in Posit studio. I’ll explain and demonstrate each cell, and then you can run them for yourself.</p>
<p>Following that, you’ll create your own new markdown notebook, and practice some of the techniques we’ve learned- and submit it to Brightspace as a weekly task.</p>
</section>
<section id="open-the-.rmd-file" class="level2">
<h2 class="anchored" data-anchor-id="open-the-.rmd-file">Open the .Rmd file</h2>
<p>To begin, click on the .Rmd file. It will open in the reading pane in the top-left. The .Rmd file is an identical copy of this chapter, except you can see the ‘source’, and can change and run the code directly.</p>
<p>If asked to install packages, go ahead and install them. It might take a few moments to complete.</p>
<p>You can switch between two views - again as we saw last week. Either ‘Source’ or ‘Visual’. In the ‘Source’ view, you’ll see the source markdown code used to write the document. The ‘Visual’ view will show the page as it would look when finished, including the images.</p>
<p>As we learned in the previous week, .Rmd files contain ‘regular’ text, as well as code cells - these are shaded boxes with <code>{r}</code> in the left corner. On the right corner, they have a number of icons. Clicking the small green triangle icon will ‘run’ the cell, meaning any code in it will be executed and the output, if any, will be displayed underneath.</p>
<p>Let’s try this here. Click on the green triangle to the right of the shaded code cell below this text:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Hello World"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hello World"</code></pre>
</div>
</div>
<p>The code (which simply tells R to print the message “Hello World” should run, and the result should appear below.</p>
</section>
<section id="r-code" class="level2">
<h2 class="anchored" data-anchor-id="r-code">R code</h2>
<p>R code, as most programming languages, involves manipulating data. Data is usually stored as <strong>variables</strong> and the manipulations are usually done by applying these variables to <strong>functions.</strong> Often, programmers will write their own functions, but in this course, we’ll exclusively use existing functions, from various packages.</p>
</section>
<section id="installing-and-loading-packages" class="level2">
<h2 class="anchored" data-anchor-id="installing-and-loading-packages">Installing and loading packages</h2>
<p>Before we begin, an important part of using R is knowing how to install and load packages. Packages are bundles of pre-made functions, usually with a specific task in mind, such as the <code>sf</code> package for geospatial analysis, or the <code>dplyr</code> package for data wrangling. Many times when using R you will use these packages.</p>
<p>In order to be able to use them, they need to first be installed, and second they need to be loaded.</p>
<p>To install a new package, use the code <code>install.packages()</code> with the package name inside, in quotation marks. For example to install the <code>palmerpenguins</code> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">'palmerpenguins'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="loading-existing-packages" class="level2">
<h2 class="anchored" data-anchor-id="loading-existing-packages">Loading existing packages</h2>
<p>Once you have installed a package, you have to tell R that it should load the functions from the package into the ‘session’, so you can use them. Do this using the command <code>library()</code>. To load the <code>tidyverse</code> package, which we’ll use in this tutorial, run the following cell:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that now, the package name does not need to be in quotation marks.</p>
<section id="base-r." class="level3">
<h3 class="anchored" data-anchor-id="base-r.">‘Base’ R.</h3>
<p>Commands using R without needing any additional packages are often called ‘base’ R. Here are some important ones to know:</p>
<p>You can assign a value to an object using <code>=</code> or <code>&lt;-</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Entering the name of a variable in the console and pressing return will return that value in the console. The same will happen if you enter it in a notebook cell (like here below), and run the cell. This is also true of any R object, such as a dataframe, vector, or list.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<p>You can do basic calculations with <code>+</code>, <code>-</code>, <code>*</code> and <code>/</code>.</p>
<p>The code below creates a variable <code>x</code>, which is the result of the calculation <code>1 + 1</code>, a variable y, which is the result of the calculation <code>4 - 2</code>, and a variable <code>z</code>, which is the result of multiplying <code>x</code> by <code>y</code>. Finally, we print the output of <code>z</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="dv">4</span> <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> x <span class="sc">*</span> y</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<section id="comparisons" class="level4">
<h4 class="anchored" data-anchor-id="comparisons">Comparisons</h4>
<p>You can compare numbers or variables using <code>==</code> (equals), <code>&gt;</code> (greater than), <code>&lt;</code>, (less than) <code>!=</code> (not equal to). These return either <code>TRUE</code> or <code>FALSE</code>, which you’ll see if you run this cell:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">==</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>x <span class="sc">&gt;</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>x <span class="sc">!=</span> z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
</section>
<section id="basic-r-data-structures" class="level3">
<h3 class="anchored" data-anchor-id="basic-r-data-structures">Basic R data structures</h3>
<p>It is worth understanding the main types of data that you’ll come across, in your environment window (top-right pane).</p>
<p>A <strong>variable</strong> is a piece of data stored with a name, which can then be used for various purposes. It’s called a variable because we can change it and re-run the same code. The simplest of these are single <strong>elements</strong>, such as a number:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<p>Next is a vector. A vector is a list of <strong>elements</strong>. A vector is created with the command <code>c()</code>, with each item in the vector placed between the brackets, and followed by a comma. If your vector is a vector of words, the words need to be in inverted commas or quotation marks.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>piece <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>fruit <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"oranges"</span>, <span class="st">"apples"</span>, <span class="st">"oranges"</span>, <span class="st">"oranges"</span>, <span class="st">"apples"</span>, <span class="st">"oranges"</span>, <span class="st">"apples"</span>, <span class="st">"bananas"</span>, <span class="st">"bananas"</span>, <span class="st">"bananas"</span>, <span class="st">"oranges"</span>, <span class="st">"bananas"</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>colour <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"orange"</span>, <span class="st">"red"</span>, <span class="st">"orange"</span>, <span class="st">"orange"</span>, <span class="st">"red"</span>, <span class="st">"orange"</span>, <span class="st">"green"</span>, <span class="st">"yellow"</span>, <span class="st">"yellow"</span>, <span class="st">"yellow"</span>, <span class="st">"orange"</span>, <span class="st">"yellow"</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>cost <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">9</span>,<span class="dv">5</span>,<span class="dv">11</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>cost_last_week <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">12</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">11</span>,<span class="dv">7</span>,<span class="dv">13</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next are dataframes. These are the spreadsheet-like objects, with rows and columns, which you’ll use in most analyses.</p>
<p>You can create a dataframe using the <code>data.frame()</code> command. You just need to pass the function each of your vectors, which will become your columns. Don’t worry about the code <code>kableExtra::kbl()</code> for now: it simply prints the table in a way which makes it very clear.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>fruit_data <span class="ot">=</span> <span class="fu">data.frame</span>(piece, fruit, colour, cost,cost_last_week, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>fruit_data <span class="sc">%&gt;%</span> kableExtra<span class="sc">::</span><span class="fu">kbl</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">piece</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">fruit</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">colour</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">cost</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">cost_last_week</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">oranges</td>
<td style="text-align: left;">orange</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">apples</td>
<td style="text-align: left;">red</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">oranges</td>
<td style="text-align: left;">orange</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">oranges</td>
<td style="text-align: left;">orange</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">apples</td>
<td style="text-align: left;">red</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;">oranges</td>
<td style="text-align: left;">orange</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: left;">apples</td>
<td style="text-align: left;">green</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: left;">bananas</td>
<td style="text-align: left;">yellow</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: left;">bananas</td>
<td style="text-align: left;">yellow</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: left;">bananas</td>
<td style="text-align: left;">yellow</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: left;">oranges</td>
<td style="text-align: left;">orange</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td style="text-align: left;">bananas</td>
<td style="text-align: left;">yellow</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>We can also use the <code>glimpse()</code> or <code>str()</code> commands to view some basic information on the dataframe (particularly useful with longer data).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(fruit_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 12
Columns: 5
$ piece          &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12
$ fruit          &lt;chr&gt; "oranges", "apples", "oranges", "oranges", "apples", "o…
$ colour         &lt;chr&gt; "orange", "red", "orange", "orange", "red", "orange", "…
$ cost           &lt;dbl&gt; 5, 10, 4, 6, 9, 5, 11, 3, 3, 4, 2, 2
$ cost_last_week &lt;dbl&gt; 7, 12, 6, 8, 11, 7, 13, 5, 5, 6, 4, 4</code></pre>
</div>
</div>
</section>
<section id="environment" class="level3">
<h3 class="anchored" data-anchor-id="environment">Environment</h3>
<p>Every time we create an object like this, it will appear within RStudio’s environment. This means it has been saved in memory as an object which can be used for other purposes. When we close RStudio, the environment disappears.</p>
<p>You can see the objects in the environment in the top-right corner (the screenshot below will only show in the book version):</p>
<p><img src="images/Screenshot 2023-09-05 at 15.26.02.png" class="img-fluid"></p>
<p>Here you’ll see everything we’ve created, and a preview of what it contains. It’s divided into <code>Data</code> and <code>Values</code>. Values are the simple things we have created. We can see that x, for example, is a single number: 4. <code>amount</code> is a vector of numbers.</p>
<p>Data contains any dataframes we have created. We can see we have created one, called <code>fruit_data</code>. We can also click on the <code>fruit_data</code> object to open it:</p>
<p><img src="images/Screenshot 2023-09-05 at 15.26.17.png" class="img-fluid"></p>
<p>Clicking on it will open a view of the dataframe in the top-left pane. You’ll see it looks much like a spreadsheet with rows and columns. This can be very useful to see how your data looks and how it has been imported.</p>
<p>You can close this tab or switch back to the .Rmd file to continue.</p>
</section>
<section id="data-types" class="level3">
<h3 class="anchored" data-anchor-id="data-types">Data types</h3>
<p>Return again at the output under the cell with the code <code>glimpse(fruit_data)</code>. Notice that to the right of the third column, the amount, has <code>&lt;dbl&gt;</code>under it, whereas the other two have <code>&lt;chr&gt;</code>? That’s because R is treating the third as a number and others as a string of characters. It’s often important to know which data type your data is in: you can’t do arithmetic on characters, for example. R has 6 data types:</p>
<ul>
<li>character</li>
<li>numeric (real or decimal)</li>
<li>integer</li>
<li>logical</li>
<li>complex</li>
<li>Raw</li>
</ul>
<p>The most commonly-used ones we’ll use in this course are <code>character</code>, <code>numeric</code>, and <code>logical</code>. <code>logical</code> is data which is either <code>TRUE</code> or <code>FALSE</code>. In R, all the items in a vector are <em>coerced</em> to the same type. So if you try to make a vector with a combination of numbers and strings, the numbers will be converted to strings, as in the example below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>fruit <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"apples"</span>, <span class="dv">5</span>, <span class="st">"oranges"</span>, <span class="dv">3</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(fruit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> chr [1:4] "apples" "5" "oranges" "3"</code></pre>
</div>
</div>
</section>
</section>
<section id="tidyverse" class="level2">
<h2 class="anchored" data-anchor-id="tidyverse">Tidyverse</h2>
<p>Most of the work in this course will use a set of packages developed for R called the ‘tidyverse’. These enhance and improve a large range of R functions with a more intuitive syntax. The Tidyverse is really a ‘family’ of individual packages for sorting, filtering and plotting data frames.</p>
<p>All these functions work in the same way. The first argument is the thing you want to operate on. This is nearly always a data frame. After come other arguments, which are often specific columns, or certain variables you want to do something with.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here are a couple of the most important ones</p>
<section id="select-pull" class="level3">
<h3 class="anchored" data-anchor-id="select-pull">select(), pull()</h3>
<p><code>select()</code> allows you to select columns. You can use names or numbers to pick the columns, and you can use a <code>-</code> sign to select everything <em>but</em> a given column.</p>
<p>Using the fruit data frame we created above: We can select just the fruit and colour columns:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(fruit_data, fruit, colour)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     fruit colour
1  oranges orange
2   apples    red
3  oranges orange
4  oranges orange
5   apples    red
6  oranges orange
7   apples  green
8  bananas yellow
9  bananas yellow
10 bananas yellow
11 oranges orange
12 bananas yellow</code></pre>
</div>
</div>
<p>Select everything but the colour column:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(fruit_data, <span class="sc">-</span>colour)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   piece   fruit cost cost_last_week
1      1 oranges    5              7
2      2  apples   10             12
3      3 oranges    4              6
4      4 oranges    6              8
5      5  apples    9             11
6      6 oranges    5              7
7      7  apples   11             13
8      8 bananas    3              5
9      9 bananas    3              5
10    10 bananas    4              6
11    11 oranges    2              4
12    12 bananas    2              4</code></pre>
</div>
</div>
<p>Select the first two columns:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(fruit_data, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   piece   fruit
1      1 oranges
2      2  apples
3      3 oranges
4      4 oranges
5      5  apples
6      6 oranges
7      7  apples
8      8 bananas
9      9 bananas
10    10 bananas
11    11 oranges
12    12 bananas</code></pre>
</div>
</div>
</section>
<section id="group_by-summarise-tally" class="level3">
<h3 class="anchored" data-anchor-id="group_by-summarise-tally">group_by(), summarise(), tally()</h3>
<p>A very useful function is <code>group_by()</code>. By itself, it groups rows of your data together based on . Once this is done, you can apply a function to each group. A useful and simple example is <code>tally()</code>. Using <code>tally()</code> on your grouped dataset will count the number of rows in each group. The diagram below is an attempt to explain how grouping works. First, the <code>group_by()</code> function takes a dataset of fruit observations, and puts them into their relevant groups. Next, <code>count()</code> or <code>tally()</code> will count the number of fruit in each group.</p>
<p><img src="images/group_by_count.drawio.png" class="img-fluid" width="600"></p>
<p>To do this in R, first you need to create a new dataframe with the grouped fruit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>grouped_fruit <span class="ot">=</span> <span class="fu">group_by</span>(fruit_data, fruit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, use <code>tally()</code> on new dataset. This counts all the instances of each fruit group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tally</span>(grouped_fruit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  fruit       n
  &lt;chr&gt;   &lt;int&gt;
1 apples      3
2 bananas     4
3 oranges     5</code></pre>
</div>
</div>
<p>See? Now the apples are grouped together rather than being two separate rows, and there’s a new column called <code>n</code>, which contains the result of the count.</p>
<p>Sometimes, we’ll want to add up the totals for some other measurement of the data. Imagine our fruit dataset also contained the cost of each fruit for each observation.</p>
<p>We could produce a new summary of the data which calculated the total cost for each group, with a small change to the method, as in this diagram:</p>
<p><img src="images/group_by_count_weight.drawio.png" class="img-fluid" width="600"></p>
<p>If we specify that we want to count by something else, we can add that in as a ‘weight’, by adding <code>wt =</code> as an argument in the function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tally</span>(grouped_fruit, <span class="at">wt =</span> cost)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  fruit       n
  &lt;chr&gt;   &lt;dbl&gt;
1 apples     30
2 bananas    12
3 oranges    22</code></pre>
</div>
</div>
<p>That counts the amounts of each fruit, ignoring the colour.</p>
</section>
<section id="filter" class="level3">
<h3 class="anchored" data-anchor-id="filter">filter()</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/cb8d9c50-f48e-4c6d-a5b3-1d30ce0be2ad.png" class="img-fluid figure-img" alt="Cartoon of cute fuzzy monsters dressed up as different X-men characters, working together to add a new column to an existing data frame. Stylized title text reads &quot;dplyr::mutate - add columns, keep existing.&quot;" width="600"></p>
<figcaption class="figure-caption">Source: https://allisonhorst.com/r-packages-functions</figcaption>
</figure>
</div>
<p>The <code>filter()</code> function keeps only certain rows in a dataframe, based on a condition which you set within the function. This is very useful when working with data visualisations, because often you will want to focus on a small amount of the data, or perhaps a single category.</p>
<p>In the <code>filter</code> function, the first argument is the data to be filtered. The second is a condition (or multiple conditions). The function will return every row where that condition is true.</p>
<p>Just red fruit:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(fruit_data, colour <span class="sc">==</span> <span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  piece  fruit colour cost cost_last_week
1     2 apples    red   10             12
2     5 apples    red    9             11</code></pre>
</div>
</div>
<p>Just fruit which cost at least 5:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(fruit_data, cost <span class="sc">&gt;=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  piece   fruit colour cost cost_last_week
1     1 oranges orange    5              7
2     2  apples    red   10             12
3     4 oranges orange    6              8
4     5  apples    red    9             11
5     6 oranges orange    5              7
6     7  apples  green   11             13</code></pre>
</div>
</div>
<p>You can also filter with multiple terms by using a vector (as above), and the special command <code>%in%</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(fruit_data, colour <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'red'</span>, <span class="st">'green'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  piece  fruit colour cost cost_last_week
1     2 apples    red   10             12
2     5 apples    red    9             11
3     7 apples  green   11             13</code></pre>
</div>
</div>
</section>
<section id="mutate" class="level3">
<h3 class="anchored" data-anchor-id="mutate">mutate()</h3>
<p>Mutate creates new columns in your dataframe, based on existing columns or variables.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/bd4ae264-ae51-4d18-bd60-7a058ab42fba.png" class="img-fluid figure-img" alt="Cartoon of cute fuzzy monsters dressed up as different X-men characters, working together to add a new column to an existing data frame. Stylized title text reads &quot;dplyr::mutate - add columns, keep existing.&quot;" width="600"></p>
<figcaption class="figure-caption">Source: https://allisonhorst.com/r-packages-functions</figcaption>
</figure>
</div>
<p>For example, we can use <code>mutate()</code> to create a new column, adding the results of <code>cost</code> and <code>cost_last_week</code>. Here, we are telling mutate to create a new column called <code>total_cost</code>, and for each row, that column should be the result of adding together the other two columns:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(fruit_data, <span class="at">total_cost =</span> cost <span class="sc">+</span> cost_last_week) <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">piece</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">fruit</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">colour</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">cost</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">cost_last_week</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">total_cost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">oranges</td>
<td style="text-align: left;">orange</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">apples</td>
<td style="text-align: left;">red</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">oranges</td>
<td style="text-align: left;">orange</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">oranges</td>
<td style="text-align: left;">orange</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">apples</td>
<td style="text-align: left;">red</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">20</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;">oranges</td>
<td style="text-align: left;">orange</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: left;">apples</td>
<td style="text-align: left;">green</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">24</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: left;">bananas</td>
<td style="text-align: left;">yellow</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: left;">bananas</td>
<td style="text-align: left;">yellow</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: left;">bananas</td>
<td style="text-align: left;">yellow</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: left;">oranges</td>
<td style="text-align: left;">orange</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td style="text-align: left;">bananas</td>
<td style="text-align: left;">yellow</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="slice_max-slice_min" class="level3">
<h3 class="anchored" data-anchor-id="slice_max-slice_min">slice_max(), slice_min()</h3>
<p>These functions return the top or bottom number of rows, ordered by the data in a particular column. We set two parameters: <code>order_by</code>, which tells the function which value to use, and <code>n</code>, which specifies the number of rows we want to return.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>fruit_data <span class="sc">%&gt;%</span> <span class="fu">slice_max</span>(<span class="at">order_by =</span> cost, <span class="at">n =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  piece  fruit colour cost cost_last_week
1     7 apples  green   11             13</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>fruit_data <span class="sc">%&gt;%</span> <span class="fu">slice_min</span>(<span class="at">order_by =</span> cost, <span class="at">n =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  piece   fruit colour cost cost_last_week
1    11 oranges orange    2              4
2    12 bananas yellow    2              4</code></pre>
</div>
</div>
<p>These can also be used with <code>group_by()</code>, to give the top rows for each group:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>fruit_data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(fruit) <span class="sc">%&gt;%</span> <span class="fu">slice_max</span>(<span class="at">order_by =</span> cost, <span class="at">n  =</span>  <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
# Groups:   fruit [3]
  piece fruit   colour  cost cost_last_week
  &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;dbl&gt;          &lt;dbl&gt;
1     7 apples  green     11             13
2    10 bananas yellow     4              6
3     4 oranges orange     6              8</code></pre>
</div>
</div>
<p>Notice it has kept only one row per fruit type, meaning it has kept only the apple row with the highest amount.</p>
</section>
<section id="sort-arrange" class="level3">
<h3 class="anchored" data-anchor-id="sort-arrange">sort(), arrange()</h3>
<p>Another useful set of functions, often you want to sort things. The function <code>arrange()</code> does this very nicely. You specify the data frame, and the variable you would like to sort by.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(fruit_data, cost)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   piece   fruit colour cost cost_last_week
1     11 oranges orange    2              4
2     12 bananas yellow    2              4
3      8 bananas yellow    3              5
4      9 bananas yellow    3              5
5      3 oranges orange    4              6
6     10 bananas yellow    4              6
7      1 oranges orange    5              7
8      6 oranges orange    5              7
9      4 oranges orange    6              8
10     5  apples    red    9             11
11     2  apples    red   10             12
12     7  apples  green   11             13</code></pre>
</div>
</div>
<p>Sorting is ascending by default, but you can specify descending using <code>desc()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(fruit_data, <span class="fu">desc</span>(cost))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   piece   fruit colour cost cost_last_week
1      7  apples  green   11             13
2      2  apples    red   10             12
3      5  apples    red    9             11
4      4 oranges orange    6              8
5      1 oranges orange    5              7
6      6 oranges orange    5              7
7      3 oranges orange    4              6
8     10 bananas yellow    4              6
9      8 bananas yellow    3              5
10     9 bananas yellow    3              5
11    11 oranges orange    2              4
12    12 bananas yellow    2              4</code></pre>
</div>
</div>
<p>If you `sort<code>arrange()</code> by a list of characters, you’ll get alphabetical order:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(fruit_data, fruit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   piece   fruit colour cost cost_last_week
1      2  apples    red   10             12
2      5  apples    red    9             11
3      7  apples  green   11             13
4      8 bananas yellow    3              5
5      9 bananas yellow    3              5
6     10 bananas yellow    4              6
7     12 bananas yellow    2              4
8      1 oranges orange    5              7
9      3 oranges orange    4              6
10     4 oranges orange    6              8
11     6 oranges orange    5              7
12    11 oranges orange    2              4</code></pre>
</div>
</div>
<p>You can sort by multiple things:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(fruit_data, fruit, <span class="fu">desc</span>(cost))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   piece   fruit colour cost cost_last_week
1      7  apples  green   11             13
2      2  apples    red   10             12
3      5  apples    red    9             11
4     10 bananas yellow    4              6
5      8 bananas yellow    3              5
6      9 bananas yellow    3              5
7     12 bananas yellow    2              4
8      4 oranges orange    6              8
9      1 oranges orange    5              7
10     6 oranges orange    5              7
11     3 oranges orange    4              6
12    11 oranges orange    2              4</code></pre>
</div>
</div>
<p>Notice that now green apples are first.</p>
</section>
<section id="left_join-inner_join-anti_join" class="level3">
<h3 class="anchored" data-anchor-id="left_join-inner_join-anti_join">left_join(), inner_join(), anti_join()</h3>
<p>Another set of commands we’ll use quite often in this course are the <code>join()</code> ‘family’. Joins are a very powerful but simple way of selecting certain subsets of data, and adding information from multiple tables together.</p>
<p>Let’s make a second table of information giving the delivery day for each fruit type:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>fruit_type <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'apples'</span>, <span class="st">'bananas'</span>,<span class="st">'oranges'</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>weekday <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'Monday'</span>, <span class="st">'Wednesday'</span>, <span class="st">'Friday'</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>fruit_days <span class="ot">=</span> <span class="fu">data.frame</span>(fruit_type, weekday, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>fruit_days</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  fruit_type   weekday
1     apples    Monday
2    bananas Wednesday
3    oranges    Friday</code></pre>
</div>
</div>
<p>This can be ‘joined’ to the fruit information, to add the new data on the delivery day, without having to edit the original table (or repeat the information for apples twice). This is done using <code>left_join</code>.</p>
<p>Joins need a common <code>key</code>, a column which allows the join to match the data tables up. It’s important that these are unique (a person’s name makes a bad key by itself, for example, because it’s likely more than one person will share the same name). Usually, we use codes as the join keys. If the columns containing the join keys have different names (as ours do), specify them using the syntax below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>joined_fruit <span class="ot">=</span> <span class="fu">left_join</span>(fruit_data, fruit_days, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"fruit"</span> <span class="ot">=</span> <span class="st">"fruit_type"</span>))</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>joined_fruit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   piece   fruit colour cost cost_last_week   weekday
1      1 oranges orange    5              7    Friday
2      2  apples    red   10             12    Monday
3      3 oranges orange    4              6    Friday
4      4 oranges orange    6              8    Friday
5      5  apples    red    9             11    Monday
6      6 oranges orange    5              7    Friday
7      7  apples  green   11             13    Monday
8      8 bananas yellow    3              5 Wednesday
9      9 bananas yellow    3              5 Wednesday
10    10 bananas yellow    4              6 Wednesday
11    11 oranges orange    2              4    Friday
12    12 bananas yellow    2              4 Wednesday</code></pre>
</div>
</div>
<p>In this new dataframe, the correct weekday is now listed beside the relevant fruit type.</p>
</section>
<section id="piping" class="level3">
<h3 class="anchored" data-anchor-id="piping">Piping</h3>
<p>Another useful feature of the tidyverse is that you can ‘pipe’ commands through a bunch of functions, making it easier to follow the logical order of the code. This means that you can do one operation, and pass the result to another operation. The previous dataframe is passed as the first argument of the next function by using the pipe <code>%&gt;%</code> command. It works like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>fruit_data <span class="sc">%&gt;%</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(colour <span class="sc">!=</span> <span class="st">'yellow'</span>) <span class="sc">%&gt;%</span> <span class="co"># remove any yellow colour fruit</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fruit) <span class="sc">%&gt;%</span> <span class="co"># group the fruit by type</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>(cost) <span class="sc">%&gt;%</span> <span class="co"># count each group</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="co"># arrange in descending order of the count</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  fruit       n
  &lt;chr&gt;   &lt;dbl&gt;
1 apples     30
2 oranges    22</code></pre>
</div>
</div>
<p>That code block, written in prose: “take fruit data, remove any yellow colour fruit, count the fruits by type and cost, and arrange in descending order of the total”</p>
</section>
</section>
<section id="reading-in-external-data" class="level2">
<h2 class="anchored" data-anchor-id="reading-in-external-data">Reading in external data</h2>
<p>Most of the time, you’ll be working with external data sources. These most commonly come in the form of comma separated values (.csv) or tab separated values (.tsv). The tidyverse commands to read these are <code>read_csv()</code> and <code>read_tsv</code>. You can also use <code>read_delim()</code>, and specify the type of delimited using <code>delim = ','</code> or <code>delim = '/t</code>. The path to the file is given as a string to the argument <code>file=</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">'top_movie.csv'</span>) <span class="co"># Read a .csv file as a network, specify the path to the file here.</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice that each column has a data type beside it, either <chr> for text or <dbl> for numbers. This is important if you want to sort or run calculations on the data.</dbl></chr></p>
<p>Advanced: <code>str_¥</code></p>
</section>
<section id="exercises" class="level2">
<h2 class="anchored" data-anchor-id="exercises">Exercises</h2>
<p>Now is a chance to practice R skills on your own.</p>
<p>First, create a new markdown notebook, following the instructions from last week.</p>
<p>Next, complete the following exercises. Type the name of the exercise, and then create a separate code cell for each one.</p>
<p>You don’t need to complete them all - get as far as you can in the rest of the time of the class, and submit. If you have unfinished code, you’ll need to delete it. .Rmd files only ‘knit’ when the code can successfully complete.</p>
<section id="section" class="level4">
<h4 class="anchored" data-anchor-id="section"></h4>
<p>Load the tidyverse library into your markdown file (for any markdown file, you need to load all the packages you use within it. It doesn’t matter if you have already loaded the packages separately.</p>
</section>
<section id="exercise-1" class="level4">
<h4 class="anchored" data-anchor-id="exercise-1">Exercise 1</h4>
<p>What will be the value of each variable after each statement in the following program? Write the answers as text directly in the Markdown document.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>mass <span class="ot">&lt;-</span> <span class="fl">47.5</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="dv">122</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>mass <span class="ot">&lt;-</span> mass <span class="sc">*</span> <span class="fl">2.3</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> age <span class="sc">-</span> <span class="dv">20</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercise-2" class="level4">
<h4 class="anchored" data-anchor-id="exercise-2">Exercise 2</h4>
<p>Enter the code from the previous exercise into your .Rmd file, and write a command to compare mass to age (see the section on comparisons above). Is mass larger than age?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>mass <span class="ot">&lt;-</span> <span class="fl">47.5</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="dv">122</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>mass <span class="ot">&lt;-</span> mass <span class="sc">*</span> <span class="fl">2.3</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> age <span class="sc">-</span> <span class="dv">20</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>mass <span class="sc">&gt;</span> age</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="exercise-3" class="level4">
<h4 class="anchored" data-anchor-id="exercise-3">Exercise 3</h4>
<p>In a new code cell, write code to install the <code>gapminder</code> library. When it is finished, load this library and the <code>tidyverse</code> library.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">'gapminder'</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="exercise-4" class="level4">
<h4 class="anchored" data-anchor-id="exercise-4">Exercise 4</h4>
<p>Upload a file to your workspace. The file is called <code>gapminder.csv</code> and it is available <a href="https://swcarpentry.github.io/r-novice-gapminder/data/gapminder_data.csv">here</a>. Download it to your local machine first and then upload to RStudio.</p>
</section>
<section id="exercise-5" class="level4">
<h4 class="anchored" data-anchor-id="exercise-5">Exercise 5</h4>
<p>In a new code cell, read the file <code>top_movie.csv</code> into R. Give it the name <code>df_movie</code>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>df_movie <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">'top_movie.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="exercise-6" class="level4">
<h4 class="anchored" data-anchor-id="exercise-6">Exercise 6</h4>
<p>In a new cell, create a new version of <code>df_movie</code>, called <code>df_movie_cleaned</code> which:</p>
<ul>
<li><p>Only includes the years 2000 to 2020.</p></li>
<li><p>Only contains the <code>year</code>, <code>movie</code>, <code>distributor</code> and <code>total_in_2022_dollars</code> columns.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>df_movie_cleaned <span class="ot">=</span> <span class="fu">select</span>(df_movie, year, movie, distributor, total_in_2022_dollars)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>df_movie_cleaned <span class="ot">=</span> <span class="fu">filter</span>(df_movie_cleaned, year <span class="sc">%in%</span> <span class="dv">2000</span><span class="sc">:</span><span class="dv">2020</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="exercise-7" class="level4">
<h4 class="anchored" data-anchor-id="exercise-7">Exercise 7</h4>
<p>Summarise the <code>df_movie_cleaned</code> data. Print the following under the cell output:</p>
<ul>
<li><p>A count of the number of titles in <code>df_movie_cleaned</code> per each distributor.</p></li>
<li><p>A count of the total box office takings for each distributor.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>grouped <span class="ot">=</span> <span class="fu">group_by</span>(df_movie_cleaned, distributor)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tally</span>(grouped)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="exercise-8" class="level4">
<h4 class="anchored" data-anchor-id="exercise-8">Exercise 8</h4>
<p>Sort the data. Sort by the total box office takings amount in descending order, and print this result under the cell.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(<span class="fu">tally</span>(grouped), <span class="fu">desc</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="exercise-9" class="level4">
<h4 class="anchored" data-anchor-id="exercise-9">Exercise 9</h4>
<p>Edit df_movie_cleaned to only include the ten highest-ranked movies, by the total box office taking.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_max</span>(df_movie_cleaned, <span class="at">order_by =</span> total_in_2022_dollars, <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="exercise-10" class="level4">
<h4 class="anchored" data-anchor-id="exercise-10">Exercise 10</h4>
<p><strong>You’ll need to have installed and loaded the <code>gapminder</code> library from the above exercise to complete this</strong>. Gapminder is a dataset of basic statistics for world countries over the past half a century. To load it into R, make a new cell, and create a new object called <code>gapminder_df</code> using the code <code>gapminder_df = gapminder</code>. Check your enviroment to ensure it has loaded correctly.</p>
<p>Using the pipe function described in the section above, perform the following tasks in a single code cell:</p>
<ol type="1">
<li><p>Take the gapminder dataset, filter to include only data from the continent <code>Asia</code>.</p></li>
<li><p>Select the <code>country</code>, <code>continent</code>, <code>lifeExp</code> and <code>gdpPercap</code> columns</p></li>
<li><p>Create a new column, called <code>gdp_lifeExp</code>, which is the result of dividing the <code>gdpPercap</code> column by the <code>lifeExp</code> column.</p></li>
<li><p>Calculate the <strong>mean (i.e.&nbsp;average)</strong> life expectancy for each <strong>country.</strong></p></li>
<li><p>(if you’re finding this easy). <code>filter()</code> can be used to filter by much more complex conditions. One powerful tool is filtering by matching string patterns, using a special language called <strong>regular expressions.</strong> For a final challenge, take your new dataset of summarised life expectancies, and filter to include only countries which <em>end</em> in the letters <strong>stan</strong>. The function you need to include in your filter is <code>str_detect()</code>.</p></li>
</ol>
</section>
<section id="finished" class="level4">
<h4 class="anchored" data-anchor-id="finished">Finished?</h4>
<p>Save and knit the markdown file, submit under ‘weekly tasks’ for week 3.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./r-markdown.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction and Using R Markdown</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./datavis-0.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Visualisation 0</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>